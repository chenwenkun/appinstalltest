<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APK兼容性测试 - 帮助</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        h2 {
            margin-top: 30px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }

        pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }

        .btn {
            display: inline-block;
            background: #0078d7;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 4px;
            margin-top: 20px;
        }

        .btn:hover {
            background: #0063b1;
        }
    </style>
</head>

<body>
    <h1>APK兼容性测试平台</h1>
    <p>帮助你快速进行APK兼容性测试，支持旧版本安装、覆盖安装新版本、自动启动验证。</p>
    <ul>
        <li>支持 Android 设备</li>
        <li>自动检测设备状态（屏幕、锁屏）</li>
        <li>支持远程 APK 管理与分发</li>
        <li>交互式测试流程（安装旧版 -> 覆盖新版）</li>
    </ul>

    <h2>安装与启动</h2>
    <div class="step">
        <h3>1. 获取代码</h3>
        <pre><code>git clone https://github.com/chenwenkun/appinstalltest.git
                cd appinstalltest</code></pre>
    </div>
    <div class="step">
        <h3>2. 安装依赖</h3>
        <pre><code>pip install -r requirements.txt</code></pre>
    </div>
    <div class="step">
        <h3>3. 启动服务</h3>
        <pre><code>python main.py</code></pre>
    </div>

    <p>服务启动后，刷新本页面即可自动跳转到控制台。</p>

    <div id="status"
        style="margin-top: 30px; padding: 15px; background: #fff3cd; border: 1px solid #ffeeba; border-radius: 4px; color: #856404;">
        正在检测本地服务...
    </div>

    <script>
        async function checkService() {
            const statusDiv = document.getElementById('status');
            try {
                // Try to connect to local service
                // If running locally, this is relative. If remote, it's localhost.
                // We'll try localhost explicit first.
                const res = await fetch('http://127.0.0.1:8791/devices');
                if (res.ok) {
                    statusDiv.innerHTML = '✅ 本地服务已启动，正在跳转...';
                    statusDiv.style.background = '#d4edda';
                    statusDiv.style.color = '#155724';
                    statusDiv.style.borderColor = '#c3e6cb';
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1000);
                }
            } catch (e) {
                statusDiv.innerHTML = '❌ 未检测到本地服务。请按照上述步骤启动服务后刷新页面。';
            }
        }

        // Check on load
        checkService();

        // Check every 2 seconds
        setInterval(checkService, 2000);
    </script>
</body>

</html>